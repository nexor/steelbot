<?php

class S {

	private static $_app = null,
				   $_logger = null;
				   
	

	public static function init($config)
	{ 
		$basicConfig = include STEELBOT_DIR.'/include/config.php';
		$dbConfig = include STEELBOT_DIR.'/database/'.$config['db']['engine'] .'/config.php';
		$protoConfig = include STEELBOT_DIR.'/protocol/'.$config['proto']['engine'].'/config.php';
		$steelbotConfig = include STEELBOT_DIR.'/config.php';

		$cfg = self::mergeArray($basicConfig, $dbConfig);
		$cfg = self::mergeArray($cfg, $protoConfig);
		$cfg = self::mergeArray($cfg, $steelbotConfig);
		$cfg = self::mergeArray($cfg, $config);
		 
		self::$_app = new Steelbot($cfg);
	}

	public static function mergeArray($a,$b)
	{
        foreach($b as $k=>$v)
        {
                if(is_integer($k))
                        $a[]=$v;
                else if(is_array($v) && isset($a[$k]) && is_array($a[$k]))
                        $a[$k]=self::mergeArray($a[$k],$v);
                else
                        $a[$k]=$v;
        }
        return $a;
	}

	public static function bot() {
		return self::$_app;
	}



}
